<!DOCTYPE html>
<html>
<head>
    <title>Notification with Service Worker</title>
</head>
<body>
    <button id="enable">Enable Notifications</button>
    <div id="status"></div>
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(reg => {
                console.log('Service Worker registered', reg);
            }).catch(err => {
                console.error('Service Worker registration failed:', err);
            });
        }

        // Ask for permission and send message to SW
        document.getElementById('enable').addEventListener('click', () => {
            Notification.requestPermission().then(permission => {
                document.getElementById('status').textContent = 'Permission: ' + permission;
                if (permission === 'granted') {
                    navigator.serviceWorker.ready.then(registration => {
                        registration.active.postMessage('show-notification');
                    });
                }
            });
        });
    </script>
</body>
</html>
